[33m===Dynamic model for quaternion module===[0m
===AOCS Scilab===


------------------------------------
     CelestLab - Version 3.0.0
           CNES - DCT/SB
------------------------------------


Start Aerospace blockset - (2.0)
	Load macros
	Load reference frames palette
	Load math oparations palette
	Load unit conversions palette
	Load environment palette
	Load orbit propagators palette
	Load utilities palette
	Load help
	Load demos

 
-->// This function compute the torque that should be generated by each thruster
 
-->// The solution is based on the Least Norm method that compute the smaller 
 
-->// solution of a underdetermined linear equation.
 
-->// Ba is the thrusters geometric configuration matrix and Controller_Torque 
 
-->// is the torque coming from the Controller.
 
-->// The Linear equation we are solving is:
 
-->// Ba*U = T_c;
 
 
-->function [Torques] = LeastNormTorque(Ba, Controller_Torque)
-->    Torque_Factor = Ba' / (Ba * Ba');
-->    Torques  = Torque_Factor * Controller_Torque;
-->endfunction
 
 
-->// This function is the angular rate controller.
 
-->// It use the Nonlinear Dynamic Inversion technique
 
-->// The inputs are: actual angular velocity, and desired angular velocity
 
-->// Ix,Iy, Iz are defined in simulation context
 
-->// Reference : Control System Application
 
 
-->function [NDI_torque]= NDI_rateControl(w, wd)
-->    // Controller Gain (can be change for performance)
-->    Cx = 10*Ix;
-->    Cy = 10*Iy;
-->    Cz = 10*Iz;
-->    Ux = -(Iy - Iz)*w(2)*w(3) - Cx*(w(1) - wd(1));
-->    Uy = -(Iz - Ix)*w(3)*w(1) - Cy*(w(2) - wd(2));
-->    Uz = -(Ix - Iy)*w(1)*w(2) - Cz*(w(3) - wd(3));
-->    NDI_torque = [Ux; Uy; Uz];
-->endfunction
 
 
-->// This function compute the matrix [Î©'] for quaternion kinematics
 
-->// Its input is the satellite angular velocity given in satellite
 
-->// body-frame.
 
-->// Reference: Strapdown Attitude Algorithms using Quaternion Transition Matrix And Random Inputs, Mohamed S.Ahmed (Attitude control)
 
 
-->function [Omega] = OmegaPrime(w)
-->    Omega = [ 0    ,  -w(1)  , -w(2) ,  -w(3);
-->              w(1) ,   0     ,  w(3) ,  -w(2);
-->              w(2) ,  -w(3) ,  0    ,  w(1);
-->              w(3) ,   w(2) , -w(1) ,  0     ];
-->endfunction
 
 
-->// Attitude Controller with Quaternion feedback
 
-->// The parameters Kx, Ky, Kz, Kxd, Kyd, Kzd are defined in the CONTEXT
 
-->// The first element in the quaternion is the constant element.
 
 
-->function [Torque] = QuaternionPD(q, w)
-->    Kx  = 0.005;    
-->    Ky  = 0.005;
-->    Kz  = 0.006;
-->    Kxd = -0.3;
-->    Kyd = -0.3;
-->    Kzd = -0.3;
-->    Torque = [ 2*Kx*q(1)*q(2) + Kxd*w(1);
-->               2*Ky*q(1)*q(3) + Kyd*w(2);
-->               2*Kz*q(1)*q(4) + Kzd*w(3)];
-->endfunction
 
 
-->// Definition of some constants:
 
-->// Inertia of the satellite and momentum wheel
 
 
-->Ix=41.87e-3; 
 
-->Iy=41.87e-3;
 
-->Iz=6.667e-3;
 
-->Ixy=0.0;
 
-->Ixz=0.0;
 
-->Iyz=0.0;
 
-->I_Sat = [ Ix,  Ixy, Ixz  ;
-->          Ixy, Iy , Iyz  ;
-->          Ixz, Iyz, Iz   ];
 
 
-->Iwx=2E-6;   // Wheel on x-axis
 
-->Iwy=Iwx;
 
-->Iwz=Iwx;
 
-->I_wheels = [Iwx, 0  , 0   ;
-->            0  , Iwy, 0   ;
-->            0  , 0  , Iwz ];
 
 
 
-->//Thruster Geometric Configuration
 
-->// COM = center of mass
 
-->// GC  = geometric center
 
 
-->X_COM=0.00;   // X position of the COM with respect to GC
 
-->Y_COM=0.000;  // Y position of the COM with respect to GC
 
-->Z_COM=0.000;  // Z position of the COM with respect to GC
 
 
-->COM   = [X_COM; Y_COM; Z_COM];
 
 
-->// T1, T2, T3, and T4 are the Thruster Torque Orientation with respect to the 
 
-->// Body frame. We will normalize these vectors in order to get unit vector and
 
-->// Then compute the Unit Torque per thruster.
 
 
-->// Thruster 1
 
-->T1=[0;-0.259;0.966];                  // Thrust vector
 
-->T1= T1 ./ sqrt(T1' * T1);                 // Normalized Thrust Vector
 
-->OM1=[0.0305;-0.0419;-0.15275] - COM;    // Thruster Position With respect to COM
 
-->To1= cross(OM1, T1);                       // Torque vector
 
 
-->// Thruster 2
 
-->T2=[0;-0.259;0.966]; 
 
-->T2=T2 ./ sqrt(T2' * T2);
 
-->OM2=[-0.0305;-0.0419;-0.15275] - COM;
 
-->To2= cross(OM2, T2);
 
 
-->// Thruster 3
 
-->T3=[0;0.259;0.966];
 
-->T3=T3 ./ sqrt(T3' * T3);
 
-->OM3=[-0.0305;0.0419;-0.15275] - COM;
 
-->To3=cross(OM3, T3);
 
 
-->// Thruster 4
 
-->T4=[0;0.259;0.966];
 
-->T4=T4 ./sqrt(T4' * T4);
 
-->OM4=[0.0305;0.0419;-0.15275] - COM;
 
-->To4= cross(OM4, T4);
 
 
-->Ba=[To1,To2,To3,To4];
 
 
-->// Thruster Impulse
 
-->Thruster_Impulse_max=60e-6;
 
-->Thruster_Impulse_min=30e-6;
 
-->Thruster_on=50;               // This define the Duty cycle of the thruster in percentage
 
-->Thruster_period=1;                // This is the period of the thruster. It is the inverse
 
-->                                     // of the frequency.        
 
 
-->// Simulation Configuration: sim time, ...
 
-->T_sim=300;
 
-->Max_Step_Size=0.05;                // Maximum time step for simulation (used for integration)
 
 
-->// Controller Setup
 
 
-->    // 1. Rate Controller
 
-->         W_desired=[0;0.1;0];  //Desired Angular velocity
 
 
-->    // 2. Attitude Controller (angle controller)
 
-->         q_desired=[0.866;0;0;0.5];  // Desired attitude quaternion 
 
 
-->// This function will write the attitude of the satellite from the simulation to a file in CIC fromat
 
 
 
-->function [] = XcosToVTSQuat(Attitude_Data,SatDate, Attitude_Type, Sat_Name, Directory, file_name)
-->    clc;
-->    dims = 2; // for string array concatenation
-->    // Header  definition
-->    Header.version = ['CIC_AEM_VERS = 1.0', 'CIC_OEM_VERS = 1.0'];
-->    Header.comment = ['COMMENT Generated by BIRDY AOCS TEAM'];
-->    Header.time    = getdate();
-->    Header.time1    = [Header.time(1),Header.time(2), Header.time(6),Header.time(7),Header.time(8),Header.time(9), Header.time(10)];
-->    correction_month = "";
-->    correction_day   = "";
-->    correction_hour = "";
-->    correction_mn = "";
-->    correction_sec = "";
-->    if Header.time(6) <10 then
-->        correction_day   = '0';
-->    end
-->    if Header.time(2) <10 then
-->        correction_month = '0';
-->    end
-->    if Header.time(7) < 10 then
-->        correction_hour = '0';
-->    end
-->    if Header.time(8) <10 then
-->        correction_mn = '0';
-->    end
-->    if Header.time(9) <10 then
-->        correction_sec = '0';
-->    end
-->    Header.time2    = strcat(['CREATION_DATE = ', string(Header.time1(1)),"-",strcat([correction_month,string(Header.time1(2))]),"-",strcat([correction_day,string(Header.time1(3))]),"T",strcat([correction_hour,string(Header.time1(4))]),":",strcat([correction_mn,string(Header.time1(5))]),":",strcat([correction_sec,string(Header.time1(6))]),".",string(Header.time1(7)) ]);
-->    Header.originator = ['ORIGINATOR = BIRDY AOCS TEAM'];
-->    Header.meta_Start = ['META_START'];
-->    Header.sat_name   = strcat(['OBJECT_NAME = ', Sat_Name]);
-->    Header.ID         = strcat(['OBJECT_ID = ', Sat_Name]);
-->    Header.Ref_frame_A  = ['REF_FRAME_A = EME2000'];
-->    Header.Ref_frame_B  = ['REF_FRAME_B = SC_BODY_1'];
-->    Header.attitude_dir = ['ATTITUDE_DIR = A2B'];
-->    Header.time_system  = ['TIME_SYSTEM = UTC'];
-->    Header.attitude_type = strcat(['ATTITUDE_TYPE = ', Attitude_Type]);
-->    Header.euler_sequence = ['EULER_ROT_SEQ = 313'];
-->    Header.meta_stop      = ['META_STOP'];
-->    // Possible Attitude Types
-->    Attitude = ['QUATERNION', 'EULER ANGLE', 'POSITION'];
-->    // Check whcih attitude the user has input
-->    if Attitude_Type == Attitude(1) then
-->        Header.euler_sequence = "";
-->    end
-->    if Attitude_Type == Attitude(3) then
-->        Header.version = Header.version(2);
-->    else
-->        Header.version = Header.version(1);
-->    end
-->    // Check if the directory provided is correct
-->    directory.check = isdir(Directory);
-->    if directory.check == 'F' then
-->        error("This Directory you provided does not exist or the Name is incorrect. Please provide a suitable directory");
-->    else
-->        FileDirectory = strcat([Directory, file_name])
-->    end
-->    // Prepare the header file
-->    HEADER = [Header.version; Header.comment;Header.time2; Header.originator;""; Header.meta_Start; ""; Header.sat_name; Header.ID; Header.Ref_frame_A; Header.Ref_frame_B; Header.attitude_dir; Header.time_system; Header.attitude_type; Header.euler_sequence; ""; Header.meta_stop; ""];
-->    // For Date
-->    for count = 1:length(Attitude_Data(:,1))
-->        Date(count,1) = SatDate;
-->        Date(count,2) = 30*count;
-->    end
-->    Formated_Attitude_Data = [Date, Attitude_Data];
-->    // Writing to file
-->    fprintfMat(FileDirectory, Formated_Attitude_Data,"%15g",HEADER);
-->endfunction
 
clc: This feature has not been implemented in this mode.
[33m===VTS generator module===[0m
[33m===VTS execution module===[0m
===VTS Execute===
QSslSocket: cannot resolve SSLv2_client_method
QSslSocket: cannot resolve SSLv2_server_method
